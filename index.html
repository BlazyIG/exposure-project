<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROJECT: EXPOSURE // SURVEILLANCE V.X</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Rajdhani:wght@500;700;900&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js" crossorigin="anonymous"></script>

    <style>
        :root {
            --neon-red: #ff003c;
            --neon-cyan: #00f3ff;
            --neon-green: #0aff0a;
            --neon-yellow: #ffbd00;
            --bg-color: #050505;
            --glass: rgba(10, 20, 30, 0.85);
            --border: 1px solid rgba(0, 243, 255, 0.2);
            --font-display: 'Rajdhani', sans-serif;
            --font-code: 'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }

        body {
            background-color: var(--bg-color);
            color: var(--neon-cyan);
            font-family: var(--font-code);
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        /* --- VIDEO & CANVAS LAYERS --- */
        #viewport {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; background: #000;
        }
        .input_video { display: none; }
        .output_canvas {
            width: 100%; height: 100%;
            object-fit: cover;
            transform: scaleX(-1); /* Mirror */
        }

        /* Scanline Overlay */
        .scanlines {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.5) 50%, rgba(0,0,0,0.5));
            background-size: 100% 4px; pointer-events: none; z-index: 5;
            opacity: 0.6;
        }

        /* --- HUD UI LAYOUT --- */
        #hud-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10;
            padding: 2vh 2vw;
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            grid-template-rows: 80px 1fr 120px;
            gap: 15px;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .panel {
            background: var(--glass);
            backdrop-filter: blur(8px);
            border: var(--border);
            padding: 15px;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
            display: flex; flex-direction: column;
            pointer-events: auto;
            position: relative;
        }
        /* Corners decoration */
        .panel::before { content: ''; position: absolute; top: 0; left: 0; width: 15px; height: 15px; border-top: 2px solid var(--neon-cyan); border-left: 2px solid var(--neon-cyan); }
        .panel::after { content: ''; position: absolute; bottom: 0; right: 0; width: 15px; height: 15px; border-bottom: 2px solid var(--neon-cyan); border-right: 2px solid var(--neon-cyan); }

        /* Areas */
        .header { grid-column: 1 / -1; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--neon-cyan); background: transparent; backdrop-filter: none; box-shadow: none; border: none; }
        .side-left { grid-row: 2; gap: 20px; }
        .side-right { grid-row: 2; grid-column: 3; text-align: right; gap: 20px; }
        .footer { grid-column: 1 / -1; grid-row: 3; display: flex; justify-content: center; align-items: center; background: transparent; border: none; box-shadow: none; backdrop-filter: none;}

        /* Typography */
        h1 { font-family: var(--font-display); font-size: 1.8rem; letter-spacing: 4px; color: #fff; text-shadow: 0 0 10px var(--neon-cyan); text-transform: uppercase; }
        h3 { font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .data-val { font-size: 1rem; color: var(--neon-cyan); font-weight: bold; }
        .data-row { display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 0.8rem; color: #aaa; }
        
        /* Threat Bar */
        #threat-container { margin-top: 10px; }
        #threat-label { font-size: 1.5rem; font-family: var(--font-display); font-weight: 900; }
        .threat-bar-bg { width: 100%; height: 8px; background: rgba(255,255,255,0.1); margin-top: 5px; }
        #threat-fill { width: 0%; height: 100%; background: var(--neon-cyan); transition: width 0.2s, background-color 0.2s; }

        /* The Button */
        #forbidden-btn {
            background: rgba(255, 0, 60, 0.05);
            border: 2px solid var(--neon-red);
            color: var(--neon-red);
            padding: 20px 50px;
            font-family: var(--font-display);
            font-size: 1.2rem;
            letter-spacing: 3px;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.2s;
            box-shadow: 0 0 20px rgba(255, 0, 60, 0.2);
            pointer-events: auto;
            position: relative;
            overflow: hidden;
        }
        #forbidden-btn:hover { background: var(--neon-red); color: #000; box-shadow: 0 0 50px var(--neon-red); }
        #forbidden-btn:active { transform: scale(0.98); }

        /* --- MATRIX MODE --- */
        #matrix-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 50; display: none;
        }
        #matrix-canvas { width: 100%; height: 100%; }
        #system-msg {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: var(--neon-green); font-size: 2rem; font-family: var(--font-code);
            text-shadow: 0 0 10px var(--neon-green);
            background: rgba(0,0,0,0.9); padding: 20px; border: 1px solid var(--neon-green);
            text-align: center;
        }

        /* --- EXPOSED RESULT LAYER --- */
        #result-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 60;
            background: rgba(5, 5, 5, 0.98);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }

        #result-content {
            display: flex;
            gap: 40px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        #captured-image {
            width: 400px;
            border: 2px solid var(--neon-red);
            box-shadow: 0 0 40px var(--neon-red);
            filter: grayscale(100%) contrast(1.2) brightness(1.1);
        }

        .result-data-panel {
            text-align: left;
            font-family: var(--font-code);
        }
        
        .result-title { font-size: 3rem; color: var(--neon-red); font-family: var(--font-display); text-shadow: 0 0 20px var(--neon-red); margin-bottom: 10px; text-transform: uppercase;}
        .result-label { color: #666; font-size: 0.9rem; margin-top: 10px; display: block; }
        .result-val { color: #fff; font-size: 1.4rem; display: block; text-shadow: 0 0 5px #fff; }

        .btn-reveal {
            margin-top: 40px;
            background: transparent; border: 1px solid #fff; color: #fff;
            padding: 15px 40px; cursor: pointer; font-family: var(--font-display); letter-spacing: 2px;
            transition: 0.3s;
        }
        .btn-reveal:hover { background: #fff; color: #000; }

        /* --- TRUTH LAYER --- */
        #truth-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 70;
            background: #000; display: none; flex-direction: column; justify-content: center; align-items: center;
            padding: 40px; text-align: center;
        }
        .truth-text { color: #ddd; font-family: sans-serif; font-size: 1.1rem; line-height: 1.6; max-width: 600px; }
        .highlight { color: var(--neon-green); font-weight: bold; }
        .signature { margin-top: 50px; font-family: var(--font-display); font-size: 1.5rem; letter-spacing: 4px; color: var(--neon-cyan); opacity: 0.8; }

        /* Animations */
        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes pulseRed { 0% { box-shadow: 0 0 10px var(--neon-red); } 50% { box-shadow: 0 0 30px var(--neon-red); } 100% { box-shadow: 0 0 10px var(--neon-red); } }

        /* Mobile adjustments */
        @media (max-width: 800px) {
            #hud-layer { grid-template-columns: 1fr; grid-template-rows: auto 1fr auto; }
            .side-left, .side-right { display: none; }
            #captured-image { width: 90vw; }
            #result-content { flex-direction: column; gap: 20px; }
            .result-data-panel { text-align: center; }
        }
    </style>
</head>
<body>

    <div id="viewport">
        <video class="input_video"></video>
        <canvas class="output_canvas" id="main-canvas"></canvas>
    </div>
    <div class="scanlines"></div>

    <div id="hud-layer">
        <div class="header">
            <div>
                <h1>EXPOSURE_PROJECT</h1>
                <div style="font-size:0.7rem; color:#666; letter-spacing:2px;">SURVEILLANCE GRID V.9.0</div>
            </div>
            <div style="text-align:right;">
                <h3>STATUS</h3>
                <span class="data-val" id="sys-status" style="color:var(--neon-yellow)">INITIALIZING...</span>
            </div>
        </div>

        <div class="panel side-left">
            <h3>BIOMETRIC TRACKING</h3>
            <div class="data-row"><span>FACE ID:</span> <span id="face-state" style="color:#fff">SEARCHING</span></div>
            <div class="data-row"><span>HANDS:</span> <span id="hand-state" style="color:#fff">SEARCHING</span></div>
            <div class="data-row"><span>EYES:</span> <span style="color:#444">DISABLED</span></div>
            
            <div style="margin-top: 15px; border-top: 1px solid #333; padding-top: 10px;">
                <h3>THREAT ANALYSIS</h3>
                <div id="threat-label" style="color:var(--neon-cyan)">SAFE</div>
                <div class="threat-bar-bg"><div id="threat-fill"></div></div>
            </div>
        </div>

        <div class="panel side-right">
            <h3>DEVICE FINGERPRINT</h3>
            <div class="data-row"><span>OS:</span> <span id="info-os" style="color:#fff">--</span></div>
            <div class="data-row"><span>BROWSER:</span> <span id="info-browser" style="color:#fff">--</span></div>
            <div class="data-row"><span>CPU CORES:</span> <span id="info-cpu" style="color:#fff">--</span></div>
            <div class="data-row"><span>MEMORY:</span> <span id="info-ram" style="color:#fff">--</span></div>
            <div class="data-row"><span>RES:</span> <span id="info-res" style="color:#fff">--</span></div>
            
            <div style="margin-top: 15px; border-top: 1px solid #333; padding-top: 10px;">
                <h3>LOCAL TIME</h3>
                <div id="info-time" class="data-val">--:--:--</div>
            </div>
        </div>

        <div class="footer">
            <button id="forbidden-btn" onclick="initiateSequence()">
                DO NOT PRESS THIS BUTTON<br>
                <span style="font-size:0.7rem; opacity:0.7;">IF YOU DON'T WANT TO BE EXPOSED</span>
            </button>
        </div>
    </div>

    <div id="matrix-layer">
        <canvas id="matrix-canvas"></canvas>
        <div id="system-msg">ACCESSING KERNEL...</div>
    </div>

    <div id="result-layer">
        <div class="result-title">SEARCH COMPLETED</div>
        
        <div id="result-content">
            <img id="captured-image" src="" alt="Subject Identified">
            
            <div class="result-data-panel">
                <span class="result-label">SUBJECT LOCATION</span>
                <span class="result-val" id="res-loc-city">UNKNOWN</span>
                <span class="result-val" id="res-loc-coords" style="font-size:1rem; color:var(--neon-cyan);">--.---, --.---</span>
                
                <span class="result-label">DEVICE ID</span>
                <span class="result-val" id="res-device">--</span>
                
                <span class="result-label">TIMESTAMP</span>
                <span class="result-val" id="res-time">--</span>
            </div>
        </div>

        <button class="btn-reveal" onclick="showTruth()">REVEAL TRUTH</button>
    </div>

    <div id="truth-layer">
        <h2 style="color:var(--neon-green); margin-bottom:20px; font-family:var(--font-display);">SIMULATION ENDED</h2>
        <p class="truth-text">
            Fortunately, <span class="highlight">this is entirely local</span>.
            <br><br>
            Your biometrics and location data never left your device. 
            This demonstration exists to show how easily modern web permissions 
            can be used to profile users in real-time.
            <br><br>
            Always check what permissions you grant.
        </p>
        <div class="signature">DomiStudios</div>
        <button onclick="location.reload()" style="margin-top:40px; background:#333; color:#fff; border:none; padding:10px 20px; cursor:pointer;">REBOOT SYSTEM</button>
    </div>

    <script>
        // --- 1. SYSTEM CONFIGURATION ---
        const config = {
            colors: {
                safe: '#00f3ff',
                warn: '#ffbd00',
                danger: '#ff003c'
            }
        };

        const state = {
            city: "UNKNOWN SECTOR",
            country: "UNKNOWN REGION",
            lat: "00.0000",
            lon: "00.0000",
            isTracking: true,
            lastNose: {x:0, y:0},
            threatLevel: 0
        };

        // --- 2. AUDIO ENGINE ---
        const AudioSys = {
            ctx: null,
            init: () => {
                AudioSys.ctx = new (window.AudioContext || window.webkitAudioContext)();
            },
            play: (freq, type, duration, vol=0.1) => {
                if(!AudioSys.ctx) AudioSys.init();
                const osc = AudioSys.ctx.createOscillator();
                const gain = AudioSys.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, AudioSys.ctx.currentTime);
                gain.gain.setValueAtTime(vol, AudioSys.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, AudioSys.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(AudioSys.ctx.destination);
                osc.start();
                osc.stop(AudioSys.ctx.currentTime + duration);
            },
            glitch: () => {
                AudioSys.play(50, 'sawtooth', 0.5, 0.5);
                setTimeout(() => AudioSys.play(1000, 'square', 0.1, 0.2), 100);
            }
        };

        // --- 3. DATA HARVESTING (Browser & Geo) ---
        function gatherSystemData() {
            // OS & Browser
            const ua = navigator.userAgent;
            let os = "Unknown OS";
            if (ua.indexOf("Win") != -1) os = "Windows NT";
            if (ua.indexOf("Mac") != -1) os = "MacOS";
            if (ua.indexOf("Linux") != -1) os = "Linux Kernel";
            if (ua.indexOf("Android") != -1) os = "Android";
            if (ua.indexOf("iPhone") != -1) os = "iOS";

            let browser = "Unknown Browser";
            if(ua.indexOf("Chrome") != -1) browser = "Chrome / Blink";
            if(ua.indexOf("Firefox") != -1) browser = "Firefox / Gecko";
            if(ua.indexOf("Safari") != -1 && ua.indexOf("Chrome") == -1) browser = "Safari / WebKit";

            // Hardware
            const cores = navigator.hardwareConcurrency || "Unknown";
            const ram = navigator.deviceMemory ? `~${navigator.deviceMemory} GB` : "Unknown";
            const res = `${window.screen.width}x${window.screen.height}`;

            // Populate DOM
            document.getElementById('info-os').innerText = os;
            document.getElementById('info-browser').innerText = browser;
            document.getElementById('info-cpu').innerText = cores;
            document.getElementById('info-ram').innerText = ram;
            document.getElementById('info-res').innerText = res;

            // Live Time
            setInterval(() => {
                const now = new Date();
                document.getElementById('info-time').innerText = now.toLocaleTimeString();
            }, 1000);
        }

        function initGeolocation() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(async (pos) => {
                    state.lat = pos.coords.latitude.toFixed(4);
                    state.lon = pos.coords.longitude.toFixed(4);
                    
                    // Attempt Reverse Geocoding
                    try {
                        const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${state.lat}&lon=${state.lon}`;
                        const resp = await fetch(url);
                        const data = await resp.json();
                        if(data.address) {
                            state.city = data.address.city || data.address.town || data.address.village || "Unknown City";
                            state.country = data.address.country || "Unknown Country";
                        }
                    } catch(e) { console.log("Geo lookup failed"); }
                }, err => {
                    console.log("Geo permission denied");
                    state.city = "PERMISSION DENIED";
                });
            }
        }

        // --- 4. MEDIAPIPE & CANVAS RENDERER ---
        const videoElement = document.querySelector('.input_video');
        const canvasElement = document.getElementById('main-canvas');
        const canvasCtx = canvasElement.getContext('2d');

        function onResults(results) {
            // Ensure canvas matches video resolution exactly (prevents alignment drift)
            if (canvasElement.width !== videoElement.videoWidth) {
                canvasElement.width = videoElement.videoWidth;
                canvasElement.height = videoElement.videoHeight;
            }

            // Draw Video
            canvasCtx.save();
            canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
            canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);
            
            // Draw Dark Overlay (Sci-Fi look)
            canvasCtx.fillStyle = "rgba(0, 10, 15, 0.3)";
            canvasCtx.fillRect(0, 0, canvasElement.width, canvasElement.height);

            if (state.isTracking) {
                // Hand Tracking
                if (results.leftHandLandmarks || results.rightHandLandmarks) {
                    document.getElementById('hand-state').innerText = "TRACKING";
                    document.getElementById('hand-state').style.color = config.colors.safe;
                    
                    drawHand(results.leftHandLandmarks);
                    drawHand(results.rightHandLandmarks);
                } else {
                    document.getElementById('hand-state').innerText = "SEARCHING";
                    document.getElementById('hand-state').style.color = "#fff";
                }

                // Face Tracking (Outline Only - NO EYES)
                if (results.faceLandmarks) {
                    document.getElementById('face-state').innerText = "LOCKED";
                    document.getElementById('face-state').style.color = config.colors.safe;

                    // Draw Face Mesh Contour
                    drawConnectors(canvasCtx, results.faceLandmarks, FACEMESH_FACE_OVAL, 
                        {color: 'rgba(0, 243, 255, 0.4)', lineWidth: 1});
                    
                    // Face Crosshair
                    const nose = results.faceLandmarks[1];
                    const x = nose.x * canvasElement.width;
                    const y = nose.y * canvasElement.height;
                    drawReticle(x, y);

                    updateThreat(nose);
                } else {
                    document.getElementById('face-state').innerText = "SEARCHING";
                    document.getElementById('face-state').style.color = "#fff";
                    updateThreat(null);
                }
            }
            canvasCtx.restore();
        }

        function drawHand(landmarks) {
            if(!landmarks) return;
            drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS, {color: 'rgba(0, 243, 255, 0.2)', lineWidth: 2});
            drawLandmarks(canvasCtx, landmarks, {color: config.colors.safe, lineWidth: 1, radius: 2});
        }

        function drawReticle(x, y) {
            canvasCtx.strokeStyle = "rgba(0, 243, 255, 0.8)";
            canvasCtx.lineWidth = 2;
            canvasCtx.beginPath();
            canvasCtx.moveTo(x-20, y); canvasCtx.lineTo(x+20, y);
            canvasCtx.moveTo(x, y-20); canvasCtx.lineTo(x, y+20);
            canvasCtx.stroke();
            canvasCtx.beginPath();
            canvasCtx.arc(x, y, 30, 0, Math.PI*2);
            canvasCtx.setLineDash([5, 5]);
            canvasCtx.stroke();
            canvasCtx.setLineDash([]);
        }

        function updateThreat(nose) {
            let movement = 0;
            if(nose) {
                // Calculate movement delta
                const delta = Math.sqrt(Math.pow(nose.x - state.lastNose.x, 2) + Math.pow(nose.y - state.lastNose.y, 2));
                movement = delta * 200; // sensitivity
                state.lastNose = {x: nose.x, y: nose.y};
            }

            // Decay or boost threat
            if(movement > 1) state.threatLevel += 2;
            else state.threatLevel -= 1;
            
            // Clamp 0-100
            if(state.threatLevel < 0) state.threatLevel = 0;
            if(state.threatLevel > 100) state.threatLevel = 100;

            // UI Update
            const bar = document.getElementById('threat-fill');
            const lbl = document.getElementById('threat-label');
            bar.style.width = state.threatLevel + "%";
            
            if(state.threatLevel < 30) {
                bar.style.backgroundColor = config.colors.safe;
                lbl.innerText = "PASSIVE";
                lbl.style.color = config.colors.safe;
            } else if(state.threatLevel < 70) {
                bar.style.backgroundColor = config.colors.warn;
                lbl.innerText = "CAUTION";
                lbl.style.color = config.colors.warn;
            } else {
                bar.style.backgroundColor = config.colors.danger;
                lbl.innerText = "WARNING";
                lbl.style.color = config.colors.danger;
            }
        }

        // --- 5. MATRIX ANIMATION ---
        const matrixCanvas = document.getElementById('matrix-canvas');
        const mCtx = matrixCanvas.getContext('2d');
        let matrixInterval;

        function runMatrix() {
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$#@%&";
            const fontSize = 16;
            const columns = matrixCanvas.width / fontSize;
            const drops = [];
            for(let x=0; x<columns; x++) drops[x] = 1;

            matrixInterval = setInterval(() => {
                mCtx.fillStyle = "rgba(0, 0, 0, 0.05)";
                mCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
                mCtx.fillStyle = "#0aff0a";
                mCtx.font = fontSize + "px monospace";

                for(let i=0; i<drops.length; i++) {
                    const text = chars.charAt(Math.floor(Math.random() * chars.length));
                    mCtx.fillText(text, i*fontSize, drops[i]*fontSize);
                    if(drops[i]*fontSize > matrixCanvas.height && Math.random() > 0.975) drops[i] = 0;
                    drops[i]++;
                }
            }, 33);
        }

        // --- 6. SEQUENCE CONTROLLER ---
        function initiateSequence() {
            AudioSys.init();
            AudioSys.play(200, 'triangle', 0.2);

            // Hide HUD
            document.getElementById('hud-layer').style.opacity = '0';
            setTimeout(() => document.getElementById('hud-layer').style.display = 'none', 500);

            // Start Matrix
            document.getElementById('matrix-layer').style.display = 'block';
            runMatrix();

            // Text Sequence
            const msgEl = document.getElementById('system-msg');
            const msgs = [
                "ACCESSING DEVICE DATA...",
                "ANALYZING SUBJECT...",
                "LINKING BIOMETRICS...",
                "SEARCHING GLOBAL DATABASES...",
                "MATCH FOUND."
            ];

            let step = 0;
            const seq = setInterval(() => {
                if(step < msgs.length) {
                    msgEl.innerText = msgs[step];
                    AudioSys.play(400 + (step*100), 'square', 0.05);
                    step++;
                } else {
                    clearInterval(seq);
                    finalCapture(); // Capture happens exactly here
                }
            }, 1000);
        }

        function finalCapture() {
            // CAPTURE IMAGE FROM CANVAS
            // We use the last rendered frame from the canvas
            AudioSys.glitch();
            const dataUrl = canvasElement.toDataURL('image/png');
            document.getElementById('captured-image').src = dataUrl;

            // Stop Matrix
            clearInterval(matrixInterval);
            document.getElementById('matrix-layer').style.display = 'none';

            // Show Results
            const resLayer = document.getElementById('result-layer');
            resLayer.style.display = 'flex';
            
            // Populate Data
            document.getElementById('res-loc-city').innerText = `${state.city.toUpperCase()}, ${state.country.toUpperCase()}`;
            document.getElementById('res-loc-coords').innerText = `${state.lat} / ${state.lon}`;
            document.getElementById('res-device').innerText = navigator.platform.toUpperCase();
            document.getElementById('res-time').innerText = new Date().toLocaleString();
        }

        function showTruth() {
            document.getElementById('result-layer').style.display = 'none';
            document.getElementById('truth-layer').style.display = 'flex';
        }

        // --- 7. BOOTSTRAP ---
        gatherSystemData();
        initGeolocation();

        const holistic = new Holistic({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`});
        holistic.setOptions({
            modelComplexity: 1,
            smoothLandmarks: true,
            enableSegmentation: false,
            refineFaceLandmarks: false // NO EYES
        });
        holistic.onResults(onResults);

        const camera = new Camera(videoElement, {
            onFrame: async () => { await holistic.send({image: videoElement}); },
            width: 1280,
            height: 720
        });
        camera.start().then(() => {
            document.getElementById('sys-status').innerText = "ONLINE";
            document.getElementById('sys-status').style.color = config.colors.safe;
        });

    </script>
</body>
</html>
